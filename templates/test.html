<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScanCare | AI-Powered Medical Report Analysis</title>
    <style>
        :root {
            /* Red/Black/White color palette */
            --bg: #0a0a0a;           /* pure black */
            --bg-elev: #1a1a1a;      /* elevated dark */
            --bg-panel: #1f1f1f;     /* panel dark gray */
            --text: #ffffff;         /* white */
            --muted: #c7c7c7;        /* soft gray */
            --accent: #ff3b3b;       /* bright red */
            --accent-2: #cc0000;     /* deep red */
            --medical-green: #66bb6a;/* healthy green */
            --border: #3a1010;       /* dark red border */
            --code: #1a0606;         /* code dark red */
            --card-bg: linear-gradient(180deg, rgba(255,59,59,0.08), rgba(204,0,0,0.04));
            --card-border: rgba(255,59,59,0.2);
            --shadow: 0 10px 30px rgba(255, 59, 59, 0.2);
        }
        * { box-sizing: border-box; }
        html, body {
            margin: 0; padding: 0; background: var(--bg); color: var(--text); scroll-behavior: smooth;
            font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
            line-height: 1.6; font-size: 16px;
            cursor: none; /* hide native cursor to fully replace with custom dot */
        }
        /* Ensure native cursor stays hidden on interactive controls */
        a, button, input, textarea, select, label, .caro-btn, .tab-btn, .copy-btn, .toggle-btn { cursor: none !important; }
        :focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; border-radius: 6px; }

        /* Navbar: centered, detached, rounded */
        .nav {
            position: fixed; top: 36px; left: 50%; transform: translateX(-50%); z-index: 20;
            width: clamp(320px, 90vw, 900px);
            display: flex; align-items: center; justify-content: space-between;
            padding: 22px 36px;
            background: rgba(0, 0, 0, 0.75);
            border: 1px solid var(--border);
            border-radius: 100px;
            box-shadow: var(--shadow);
            backdrop-filter: blur(10px);
            transition: top .28s ease, padding .28s ease, border-radius .28s ease, background .28s ease, transform .28s ease;
        }
        /* Shrink state applied on scroll: pulls closer to top and tightens spacing */
        .nav.shrink {
            top: 12px;
            padding: 12px 18px;
            border-radius: 18px;
            background: rgba(0, 0, 0, 0.85);
            transform: translateX(-50%) translateY(0);
        }
        .nav-left { display: flex; align-items: center; gap: 18px; }
        .brand { display: flex; align-items: center; gap: 12px; }
    .brand img.logo { height: 36px; width: auto; display: block; filter: drop-shadow(0 2px 10px rgba(255, 255, 255, 0.25)); transition: height .28s ease, filter .28s ease; }
        .nav.shrink .brand img.logo { height: 26px; filter: drop-shadow(0 1px 6px rgba(255,255,255,0.2)); }
        .links a {
            position: relative;
            color: rgba(255,255,255,0.9);
            margin-left: 20px; text-decoration: none; font-weight: 600; font-size: 15px; letter-spacing: 0.2px;
            transition: color .2s ease, text-shadow .2s ease, margin .28s ease, font-size .28s ease;
        }
        .nav.shrink .links a { margin-left: 14px; font-size: 14px; }
        .links a::after{
            content: ""; position: absolute; left: 0; right: 0; bottom: -8px; height: 2px;
            background: linear-gradient(90deg, rgba(214,214,214,0.95), rgba(214,214,214,0.6));
            transform: scaleX(0); transform-origin: left; transition: transform .2s ease;
            border-radius: 2px;
        }
        .links a:hover { color: #ffffff; text-shadow: 0 0 16px rgba(255, 255, 255, 0.25); }
        .links a:hover::after { transform: scaleX(1); }

        /* Try now button */
        .btn-try {
            display: inline-flex; align-items: center; gap: 10px;
            padding: 10px 16px; margin-left: 0;
            /* Red gradient theme */
            background: linear-gradient(135deg, #ff3b3b 0%, #cc0000 50%, #aa0000 100%);
            color: #ffffff; border-radius: 999px; font-weight: 800; letter-spacing: .2px; text-decoration: none;
            border: 1px solid rgba(255,59,59,0.4);
            box-shadow: 0 0 20px rgba(255,59,59,0.4), inset 0 1px 0 rgba(255,255,255,0.2);
            transition: transform .15s ease, filter .15s ease, box-shadow .15s ease, background .15s ease, padding .28s ease;
        }
        .nav.shrink .btn-try { padding: 8px 12px; }
        .btn-try:hover {
            transform: translateY(-1px);
            filter: brightness(1.15);
            box-shadow: 0 0 30px rgba(255,59,59,0.6), 0 14px 30px rgba(255,59,59,0.4);
            background: linear-gradient(135deg, #ff5555 0%, #dd0000 50%, #bb0000 100%);
            color: #ffffff; text-decoration: none;
        }
        .btn-try::after { content: none; }

        @keyframes arrow-nudge {
            0% { transform: translateX(0); }
            50% { transform: translateX(2px); }
            100% { transform: translateX(0); }
        }
        .btn-try .arrow {
            display: inline-grid; place-items: center; transition: transform .18s ease; animation: arrow-nudge 1.6s ease-in-out infinite;
            width: 22px; height: 22px; border-radius: 999px; background: rgba(255,255,255,0.25); color: #ffffff; font-size: 14px; line-height: 1;
        }
        .nav.shrink .btn-try .arrow { width: 20px; height: 20px; font-size: 12px; }
        .btn-try:hover .arrow { transform: translateX(4px); background: rgba(255,255,255,0.35); color: #ffffff; }

        /* Hero with Spline */
        .hero { position: relative; height: 100vh; width: 100%; overflow: hidden; }
        .spline-container { position: absolute; inset: 0; display: flex; justify-content: center; align-items: center; }
        .spline-container iframe { width: 100%; height: 100%; transform: scale(1.2); border: 0; }
        .hero-title { position: absolute; bottom: 40px; left: 40px; font-size: 32px; font-weight: 700; text-shadow: 0 6px 24px rgba(0,0,0,0.5); }
        .hero-title strong { color: var(--accent); }

        /* Main sections */
        main { position: relative; z-index: 1; }
    .section { max-width: 1280px; margin: 0 auto; padding: 96px 24px; }
        .section { scroll-margin-top: 96px; }
    .section h2 { margin: 0 0 16px; font-size: 36px; letter-spacing: 0.2px; }
    .section p.lead { color: var(--muted); margin: 0 0 28px; font-size: 18px; }

        .panel { background: var(--bg-panel); border: 1px solid var(--border); border-radius: 14px; padding: 20px; box-shadow: var(--shadow); }
        .row { display: grid; grid-template-columns: 1fr; gap: 16px; }
        @media (min-width: 900px) { .row.two { grid-template-columns: 1fr 1fr; } }

        /* (removed unused screenshot/window styles) */
        /* .screenshot-frame, .window-chrome, .dot, .window-title, .screenshot-body */
        .content { display: grid; gap: 20px; }
    .card { background: var(--card-bg); border: 1px solid var(--card-border); border-radius: 16px; padding: 18px; }
    .input-row { display: grid; grid-template-columns: 1fr auto; gap: 16px; align-items: end; }
        .result-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 900px) { .result-grid { grid-template-columns: 1fr; } }

        .label-row { display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; gap: 10px; }
        label { display: block; font-weight: 700; letter-spacing: .2px; margin-bottom: 8px; color: var(--text); font-size: 15px; }
        textarea {
            width: 100%; min-height: 160px; resize: vertical;
            background: var(--bg-elev); color: var(--text);
            border: 1px solid var(--border); border-radius: 12px; padding: 12px; font-size: 15px;
            transition: box-shadow .15s ease, border-color .15s ease;
        }
    textarea:focus { outline: none; border-color: rgba(255,255,255,0.35); box-shadow: 0 0 0 2px rgba(255,255,255,0.14); }
        .hint { color: var(--muted); font-size: 12px; margin-top: 8px; opacity: 0.9; }
        
        /* Medical Chat Interface Styles - Enhanced Red/Black Theme */
        .chat-container {
            max-width: 1000px;
            margin: 40px auto 0;
        }
        .chat-box {
            background: linear-gradient(180deg, rgba(31,31,31,0.95), rgba(20,20,20,0.98));
            border: 2px solid rgba(255,59,59,0.3);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(255,59,59,0.15), 0 0 30px rgba(0,0,0,0.5);
        }
        .chat-messages {
            max-height: 500px;
            overflow-y: auto;
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 16px;
            background: linear-gradient(180deg, rgba(10,10,10,0.7), rgba(15,15,15,0.5));
            border-bottom: 1px solid rgba(255,59,59,0.1);
        }
        .message {
            display: flex;
            gap: 12px;
            animation: slideIn 0.3s ease;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        .bot-message .message-avatar {
            background: linear-gradient(135deg, #ff3b3b, #cc0000);
            border: 2px solid rgba(255,59,59,0.4);
        }
        .user-message .message-avatar {
            background: linear-gradient(135deg, #ffffff, #e0e0e0);
            color: #000000;
            border: 2px solid rgba(255,255,255,0.3);
        }
        .message-content {
            flex: 1;
            background: rgba(20,20,20,0.6);
            padding: 16px 20px;
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.12);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transition: all 0.2s ease;
        }
        .message-content:hover {
            background: rgba(25,25,25,0.7);
            border-color: rgba(255,59,59,0.2);
            box-shadow: 0 6px 16px rgba(255,59,59,0.1);
        }
        .user-message .message-content {
            background: linear-gradient(135deg, rgba(255,59,59,0.15), rgba(204,0,0,0.1));
            border: 1px solid rgba(255,59,59,0.3);
        }
        .user-message .message-content:hover {
            background: linear-gradient(135deg, rgba(255,59,59,0.2), rgba(204,0,0,0.15));
            border-color: rgba(255,59,59,0.4);
        }
        .message-content p {
            margin: 0 0 8px 0;
            line-height: 1.6;
        }
        .message-content p:last-child {
            margin-bottom: 0;
        }
        .message-content strong {
            color: #ff3b3b;
        }
        .message-content ul {
            margin: 8px 0;
            padding-left: 20px;
        }
        .message-content li {
            margin: 6px 0;
            line-height: 1.5;
        }
        .message-content em {
            color: rgba(255,255,255,0.7);
            font-style: italic;
        }
        .chat-input-area {
            padding: 24px;
            background: linear-gradient(180deg, rgba(26,26,26,0.95), rgba(20,20,20,0.98));
            border-top: 1px solid rgba(255,59,59,0.2);
        }
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .input-group textarea {
            min-height: 90px;
            font-size: 14px;
            font-family: inherit;
            background: rgba(10,10,10,0.8);
            border: 2px solid rgba(255,59,59,0.2);
            transition: all 0.2s ease;
        }
        .input-group textarea:focus {
            border-color: rgba(255,59,59,0.5);
            box-shadow: 0 0 0 3px rgba(255,59,59,0.1), 0 4px 12px rgba(255,59,59,0.2);
            background: rgba(15,15,15,0.9);
        }
        .input-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            align-items: center;
        }
        .file-upload-btn {
            background: rgba(255,255,255,0.08);
            color: rgba(255,255,255,0.95);
            border: 1px solid rgba(255,255,255,0.2);
            padding: 11px 18px;
            border-radius: 10px;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .file-upload-btn:hover {
            background: rgba(255,255,255,0.14);
            border-color: rgba(255,59,59,0.3);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255,59,59,0.2);
        }
        .send-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 11px 24px;
            font-size: 14px;
            font-weight: 700;
        }
        .input-hint {
            color: rgba(199,199,199,0.8);
            font-size: 12px;
            margin-top: 10px;
            text-align: center;
            font-weight: 500;
        }
        .loading-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--accent);
            font-size: 14px;
            font-weight: 600;
        }
        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,59,59,0.3);
            border-top-color: #ff3b3b;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        /* Custom scrollbar for chat */
        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }
        .chat-messages::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.3);
            border-radius: 4px;
        }
        .chat-messages::-webkit-scrollbar-thumb {
            background: rgba(255,59,59,0.4);
            border-radius: 4px;
        }
        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: rgba(255,59,59,0.6);
        }
        
        button {
            background: linear-gradient(135deg, #ff3b3b, #cc0000);
            color: #ffffff; font-weight: 700; border: none; border-radius: 12px; padding: 14px 22px; cursor: pointer;
            box-shadow: 0 8px 20px rgba(255, 59, 59, 0.3);
            transition: transform .15s ease, box-shadow .15s ease, filter .15s ease;
        }
        button:hover { filter: brightness(1.15); transform: translateY(-1px); box-shadow: 0 12px 28px rgba(255, 59, 59, 0.45); }
        .btn-outline { background: transparent; color: rgba(255,255,255,0.95); border: 1px solid rgba(255,255,255,0.22); box-shadow: none; padding: 14px 18px; }
        .btn-outline:hover { background: rgba(255,255,255,0.06); box-shadow: none; }

        .copy-btn {
            background: rgba(255,255,255,0.06);
            color: rgba(255,255,255,0.9);
            border: 1px solid rgba(255,255,255,0.15);
            padding: 6px 10px; border-radius: 8px; font-weight: 600; font-size: 12px; cursor: pointer;
            transition: background .15s ease, color .15s ease, border-color .15s ease, transform .15s ease;
        }
        .copy-btn:hover { background: rgba(255,255,255,0.1); transform: translateY(-1px); }

    /* New Workbench layout */
    .workbench { border: 1px solid rgba(255,255,255,0.1); border-radius: 16px; overflow: hidden; background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.015)); box-shadow: 0 18px 44px rgba(0,0,0,0.4); }
    .wb-header { display: flex; align-items: center; justify-content: space-between; gap: 16px; padding: 14px 16px; background: rgba(10,10,10,0.8); border-bottom: 1px solid rgba(255,255,255,0.08); }
    .wb-title { display: flex; align-items: center; gap: 12px; font-weight: 800; letter-spacing: .2px; }
    .wb-actions { display: flex; align-items: center; gap: 10px; }
    .wb-body { padding: 16px; }
    .grid.two { display: grid; grid-template-columns: 1.1fr 1fr; gap: 16px; }
    /* Resizable split */
    .grid.two.resizable { grid-template-columns: var(--left-col, 1.1fr) 8px var(--right-col, 1fr); align-items: stretch; }
    .divider { width: 8px; border-radius: 8px; background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.08)); cursor: col-resize; transition: background .15s ease, box-shadow .15s ease; }
    .divider:hover { background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.14)); box-shadow: 0 0 0 2px rgba(255,255,255,0.05) inset; }
    @media (max-width: 1000px) { .grid.two.resizable { grid-template-columns: 1fr; } .divider { display: none; } }
    @media (max-width: 1000px) { .grid.two { grid-template-columns: 1fr; } }

    /* Ensure right (flow) panel matches left chat height and expands cleanly */
    #flowCard { display: flex; flex-direction: column; min-height: 480px; }
    #flowCard .tabbar { flex: 0 0 auto; }
    #flowCard .tab { flex: 1 1 auto; display: none; overflow: auto; }
    #flowCard .tab.active { display: flex; flex-direction: column; opacity: 1; transform: none; }
    #flowCard .pre-container { flex: 1 1 auto; max-height: none; display: flex; flex-direction: column; }
    #flowCard pre { flex: 1 1 auto; }

    /* Tabs */
    .tabbar { display: flex; gap: 8px; background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08); border-radius: 10px; padding: 6px; margin-bottom: 12px; }
    .tab-btn { background: transparent; color: rgba(255,255,255,0.85); border: none; border-radius: 8px; padding: 8px 12px; font-weight: 700; cursor: pointer; transition: background .15s ease, color .15s ease; }
    .tab-btn.active { background: rgba(255,255,255,0.12); color: #fff; }
    .tab { display: none; opacity: 0; transform: translateY(4px); transition: opacity .18s ease, transform .18s ease; }
    .tab.active { display: block; opacity: 1; transform: translateY(0); }

    /* Select (Examples) */
    .select { background: rgba(255,255,255,0.04); color: #fff; border: 1px solid rgba(255,255,255,0.16); border-radius: 10px; padding: 10px 12px; font-weight: 600; appearance: none; outline: none; }
    .select:focus { border-color: rgba(255,255,255,0.35); box-shadow: 0 0 0 2px rgba(255,255,255,0.14); }

    /* Send button loading state */
    #sendBtn { position: relative; display: inline-flex; align-items: center; gap: 10px; }
    #sendBtn .spinner { width: 14px; height: 14px; border: 2px solid rgba(255,255,255,0.35); border-top-color: #ffffff; border-radius: 50%; display: none; animation: spin 0.8s linear infinite; }
    #sendBtn.loading .spinner { display: inline-block; }
    #sendBtn.loading .btn-label { opacity: 0.7; }
    button:disabled, .btn-outline:disabled { opacity: 0.6; cursor: not-allowed; filter: none; transform: none; }
    @keyframes spin { to { transform: rotate(360deg); } }

        pre {
            background: var(--code); color: #dbeafe; border: 1px solid var(--border);
            border-radius: 12px; padding: 12px; white-space: pre-wrap; word-break: break-word; font-size: 14px; line-height: 1.5;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            max-height: 320px; overflow: auto;
        }
        /* Global wrap toggle */
        body.no-wrap pre { white-space: pre; word-break: normal; overflow: auto; }

        /* Collapsible pre containers for big content */
        .pre-container { position: relative; max-height: 280px; overflow: hidden; border-radius: 12px; }
        .pre-container.expanded { max-height: none; }
    .pre-container .fade { content: ""; position: absolute; left: 0; right: 0; bottom: 0; height: 60px; background: linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,0.85)); display: none; pointer-events: none; border-bottom-left-radius: 12px; border-bottom-right-radius: 12px; }
        .pre-container.collapsed .fade { display: block; }

        .toggle-btn { background: rgba(255,255,255,0.06); color: rgba(255,255,255,0.9); border: 1px solid rgba(255,255,255,0.15); padding: 6px 10px; border-radius: 8px; font-weight: 600; font-size: 12px; cursor: pointer; transition: background .15s ease, transform .15s ease; }
        .toggle-btn:hover { background: rgba(255,255,255,0.1); transform: translateY(-1px); }

    /* Problems section (Why Armor) */
    .problem-section h2 { margin: 0 0 8px; font-size: 34px; }
    .problem-section p.sub { color: var(--muted); margin: 0 0 28px; font-size: 17px; }
    .problem-grid { display: grid; grid-template-columns: 1fr; gap: 18px; }
    @media (min-width: 900px) { .problem-grid { grid-template-columns: repeat(3, 1fr); } }
    .problem-card { position: relative; background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.015)); border: 1px solid rgba(255,255,255,0.08); border-radius: 16px; padding: 22px; box-shadow: 0 16px 40px rgba(0,0,0,0.35); overflow: hidden; }
    .problem-card::after { content: attr(data-idx); position: absolute; top: 16px; right: 16px; font-weight: 800; font-size: 56px; color: rgba(214,214,214,0.12); letter-spacing: 1px; }
    .p-icon { width: 56px; height: 56px; border-radius: 14px; display: grid; place-items: center; background: radial-gradient(60% 60% at 50% 30%, rgba(255,59,59,0.3), rgba(204,0,0,0.15)); border: 1px solid rgba(255,59,59,0.35); color: var(--accent); margin-bottom: 14px; box-shadow: 0 10px 30px rgba(255,59,59,0.25); }
    .problem-card h3 { margin: 0 0 8px; font-size: 20px; }
    .problem-card p { margin: 0 0 12px; color: var(--muted); }
    .p-metric { margin-top: 14px; font-weight: 800; font-size: 22px; color: var(--accent); }
    .p-metric small { display: block; font-weight: 700; font-size: 12px; color: rgba(255,255,255,0.55); letter-spacing: .3px; margin-top: 4px; text-transform: uppercase; }

        /* Features stack (card pile) */
        .features-section h2 { margin: 0 0 8px; font-size: 34px; }
        .features-section p.sub { color: var(--muted); margin: 0 0 28px; font-size: 17px; }
        .carousel { position: relative; max-width: 1100px; margin: 0 auto; }
        .stack { position: relative; display: grid; grid-auto-flow: column; grid-auto-columns: 88%; gap: 20px; overflow-x: auto; padding: 10px 8px 14px; scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch; }
        .stack::-webkit-scrollbar { height: 8px; }
        .stack::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.12); border-radius: 8px; }
        .stack-card {
            position: relative; top: auto;
            width: 100%; border-radius: 16px; padding: 22px; box-sizing: border-box; scroll-snap-align: center;
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.95), rgba(15,15,15,0.90));
            border: 1px solid rgba(255,255,255,0.12);
            box-shadow: 0 18px 44px rgba(0,0,0,0.40);
            transform: scale(0.95);
            transition: transform .25s ease, box-shadow .25s ease;
            overflow: hidden; isolation: isolate; z-index: 1;
        }
        .stack-card.active { transform: scale(1); box-shadow: 0 28px 64px rgba(0,0,0,0.55); z-index: 2; }
    .stack-card::after { content: attr(data-idx); position: absolute; right: 18px; top: 12px; font-weight: 800; font-size: 56px; color: rgba(214,214,214,0.12); }
        .f-head { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; }
    .f-icon { width: 48px; height: 48px; border-radius: 12px; display: grid; place-items: center; background: radial-gradient(60% 60% at 50% 30%, rgba(255,59,59,0.3), rgba(204,0,0,0.15)); border: 1px solid rgba(255,59,59,0.35); color: var(--accent); }
        .f-title { font-size: 20px; font-weight: 800; letter-spacing: .2px; }
        .f-body { color: var(--muted); margin: 0 0 10px; }
        .feature-list { list-style: none; padding: 0; margin: 10px 0 0; display: grid; gap: 8px; }
        .feature-list li { position: relative; padding-left: 20px; word-break: break-word; }
    .feature-list li::before { content: ""; position: absolute; left: 0; top: 8px; width: 8px; height: 8px; border-radius: 50%; background: var(--accent); box-shadow: 0 0 10px rgba(255,255,255,0.25); }

        /* Carousel nav */
        .caro-btn { position: absolute; top: 50%; transform: translateY(-50%); width: 40px; height: 40px; border-radius: 999px; display: grid; place-items: center; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.16); color: #fff; cursor: pointer; transition: background .15s ease, transform .15s ease; }
        .caro-btn:hover { background: rgba(255,255,255,0.14); transform: translateY(-50%) scale(1.03); }
        .caro-btn:disabled { opacity: .4; cursor: not-allowed; }
        .caro-btn.prev { left: -6px; }
        .caro-btn.next { right: -6px; }

        @media (prefers-reduced-motion: reduce) {
            .stack-card { transition: none; }
        }

        /* How it works (vertical timeline) */
        .how-section h2 { margin: 0 0 8px; font-size: 34px; }
        .how-section p.sub { color: var(--muted); margin: 0 0 28px; font-size: 17px; }
        .timeline { position: relative; max-width: 1100px; margin: 0 auto; display: grid; gap: 36px; }
        /* Track */
        .timeline::before { content: ""; position: absolute; left: 88px; top: 0; bottom: 0; width: 2px; background: rgba(255,255,255,0.08); border-radius: 2px; }
        /* Progress bar that grows downward while scrolling */
    .timeline .progress { position: absolute; left: 88px; top: 0; width: 3px; height: 100%; background: linear-gradient(180deg, rgba(255,255,255,1), rgba(255,255,255,0.2)); border-radius: 3px; box-shadow: 0 0 16px rgba(255,255,255,0.25); transform-origin: top; transform: scaleY(0); }
        .step { position: relative; display: grid; grid-template-columns: 176px 1fr; align-items: start; gap: 12px; }
    .step::after { content: attr(data-idx); position: absolute; left: 0; top: 10px; font-weight: 900; font-size: 88px; color: rgba(214,214,214,0.12); pointer-events: none; transform: translateX(-20px); }
    .step .icon-badge { width: 64px; height: 64px; border-radius: 16px; display: grid; place-items: center; background: radial-gradient(60% 60% at 50% 30%, rgba(255,59,59,0.3), rgba(204,0,0,0.15)); border: 1px solid rgba(255,59,59,0.35); color: var(--accent); margin-left: 56px; box-shadow: 0 10px 30px rgba(255,59,59,0.25); }
    .step .icon-badge svg { filter: drop-shadow(0 2px 8px rgba(255,59,59,0.35)); }
        .step-card { background: linear-gradient(180deg, rgba(0, 0, 0, 0.95), rgba(15,15,15,0.90)); border: 1px solid rgba(255,255,255,0.10); border-radius: 16px; padding: 22px; box-shadow: 0 18px 44px rgba(0,0,0,0.40); position: relative; }
        .step-card h3 { margin: 0 0 8px; font-size: 22px; }
        .step-card p { margin: 0 0 12px; color: var(--muted); }
        .pill { display: inline-block; padding: 8px 12px; border-radius: 999px; border: 1px solid rgba(255,255,255,0.14); background: rgba(255,255,255,0.06); font-weight: 700; font-size: 12px; letter-spacing: .2px; }
        @media (max-width: 900px){
            .timeline::before, .timeline .progress { left: 48px; }
            .step { grid-template-columns: 120px 1fr; }
            .step .icon-badge { margin-left: 16px; }
        }

        /* Micro hover lifts */
        .problem-card, .stack-card, .step-card, .card, .stat { transition: transform .2s ease, box-shadow .2s ease; }
        .problem-card:hover, .step-card:hover, .card:hover, .stat:hover { transform: translateY(-4px); box-shadow: 0 22px 60px rgba(0,0,0,0.5); }
        .stack-card:hover:not(.interactive) { transform: scale(0.97) translateY(-2px); }

        /* Immersive interactive spotlight + tilt */
        .interactive { position: relative; will-change: transform; transform-style: preserve-3d; }
        .interactive::before { content: ""; position: absolute; inset: -1px; border-radius: inherit; pointer-events: none; opacity: 0; transition: opacity .2s ease; mix-blend-mode: screen;
            background: radial-gradient(220px 220px at var(--mx,50%) var(--my,50%), rgba(255,255,255,0.18), rgba(255,255,255,0)); }
        .interactive:hover::before { opacity: 1; }

        /* Final CTA section */
        .cta-section { position: relative; padding: 120px 24px 140px; overflow: hidden; }
        .cta-wrap { max-width: 1100px; margin: 0 auto; text-align: center; position: relative; }
    .cta-halo { position: absolute; inset: -20% -10% auto -10%; height: 70%; pointer-events: none; background: radial-gradient(60% 60% at 50% 0%, rgba(255,255,255,0.10), rgba(255,255,255,0)); filter: blur(40px); }
        .cta-section h2 { font-size: 40px; line-height: 1.1; margin: 0 0 10px; letter-spacing: .2px; }
        .cta-section p.sub { color: var(--muted); margin: 0 auto 26px; font-size: 18px; max-width: 760px; }
        .cta-stats { display: grid; grid-template-columns: 1fr; gap: 16px; max-width: 980px; margin: 26px auto 34px; }
        @media (min-width: 860px){ .cta-stats { grid-template-columns: repeat(3, 1fr); } }
        .stat { background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02)); border: 1px solid rgba(255,255,255,0.10); border-radius: 16px; padding: 22px; text-align: center; box-shadow: 0 18px 44px rgba(0,0,0,0.40); }
    .stat .num { font-size: 28px; font-weight: 900; letter-spacing: .4px; margin-bottom: 6px; color: #ffffff; }
        .stat .label { color: var(--muted); font-weight: 700; font-size: 12px; letter-spacing: .3px; text-transform: uppercase; }
        .cta-actions { display: flex; align-items: center; justify-content: center; gap: 16px; margin-top: 6px; flex-wrap: wrap; }
        .cta-btn { display: inline-flex; align-items: center; gap: 12px; padding: 14px 22px; border-radius: 999px; font-weight: 800; letter-spacing: .2px; border: 1px solid rgba(255,59,59,0.4); color: #ffffff; cursor: pointer; text-decoration: none; box-shadow: 0 0 20px rgba(255,59,59,0.4), 0 10px 24px rgba(255,59,59,0.3); background: linear-gradient(135deg, #ff3b3b 0%, #cc0000 50%, #aa0000 100%);
            transition: transform .15s ease, filter .15s ease, box-shadow .15s ease, background .15s ease; }
        .cta-btn:hover { transform: translateY(-1px); filter: brightness(1.15); box-shadow: 0 0 30px rgba(255,59,59,0.6), 0 14px 30px rgba(255,59,59,0.4); background: linear-gradient(135deg, #ff5555 0%, #dd0000 50%, #bb0000 100%); color: #fff; }
    .cta-btn .arrow { width: 26px; height: 26px; display: inline-grid; place-items: center; border-radius: 999px; font-size: 16px; background: rgba(255,255,255,0.25); color: #ffffff; transition: transform .18s ease, background .18s ease, color .18s ease; }
        .cta-btn:hover .arrow { transform: translateX(4px); background: rgba(255,255,255,0.35); color: #fff; }
        .cta-link { color: rgba(255,255,255,0.92); text-decoration: none; font-weight: 700; padding: 10px 12px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.14); background: rgba(255,255,255,0.04); }
        .cta-link:hover { background: rgba(255,255,255,0.08); }

    .status { font-weight: 700; margin-bottom: 12px; display: inline-flex; align-items: center; gap: 8px; padding: 8px 12px; border-radius: 999px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.18); }
    .status.success { color: #86efac; background: rgba(16, 60, 36, 0.35); border-color: rgba(34,197,94,0.35); }
    .status.blocked { color: #fca5a5; background: rgba(60, 20, 20, 0.35); border-color: rgba(239,68,68,0.35); }
    .status.warn { color: #fcd34d; background: rgba(60, 48, 16, 0.35); border-color: rgba(245,158,11,0.35); }

        .footer { text-align: center; color: var(--muted); padding: 48px 20px; border-top: 1px solid var(--border); }

        /* Ultra-light custom cursor dot (no lag) */
        .cursor-dot {
            position: fixed;
            left: 0; top: 0;
            width: 10px; height: 10px;
            background: #ff3b3b; /* red accent */
            border-radius: 50%;
            pointer-events: none; /* never block clicks */
            z-index: 9999;
            opacity: 1;
            transform: translate3d(-100px, -100px, 0); /* off-screen until first move */
            will-change: transform; /* hint GPU accel */
            box-shadow: 0 0 10px rgba(255, 59, 59, 0.6); /* red glow effect */
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="nav">
        <div class="nav-left">
            <div class="brand"><img class="logo" src="{{ url_for('static', filename='llm.png') }}" alt="ScanCare Logo" /></div>
            <div class="links">
                <a href="#hero" aria-label="Go home">Home</a>
                <a href="#features" aria-label="View features">Features</a>
                <a href="#how" aria-label="See how it works">How it works</a>
            </div>
        </div>
        <a class="btn-try" href="#demo" aria-label="Try ScanCare now"><span>Try now</span><span class="arrow">‚Üí</span></a>
    </nav>

    <!-- Hero Spline Embed -->
    <header class="hero" id="hero">
        <div class="spline-container">
            <iframe src='https://my.spline.design/prismcoin-jW1KTaG3mdN5thoy7W6cOqfM/' frameborder='0' title="Spline Scene"></iframe>
        </div>
    </header>

    <main>
        <!-- Live Demo -->
        <section class="section" id="demo">
            <h2>ScanCare AI Assistant</h2>
            <p class="lead">Upload or paste your medical reports for instant AI-powered analysis and insights.</p>
            
            <!-- Medical Report Chat Interface -->
            <div class="chat-container">
                <div class="chat-box">
                    <div class="chat-messages" id="chatMessages">
                        <div class="message bot-message">
                            <div class="message-avatar">ü©∫</div>
                            <div class="message-content">
                                <p><strong>Hello! I'm ScanCare AI Assistant.</strong></p>
                                <p>I can help you understand your medical reports. You can:</p>
                                <ul>
                                    <li>üìÑ Paste your medical report text below</li>
                                    <li>üìÅ Upload a file (PDF, image, DOCX, or TXT)</li>
                                    <li>üí¨ Ask me health questions</li>
                                </ul>
                                <p style="font-size: 0.9em; color: var(--muted); margin-top: 12px;">
                                    <em>Note: This is an AI tool for educational purposes. Always consult healthcare professionals for medical advice.</em>
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chat-input-area">
                        <div class="input-group">
                            <textarea 
                                id="chatInput" 
                                placeholder="Paste your medical report or ask a health question..."
                                rows="3"
                            ></textarea>
                            <div class="input-actions">
                                <label for="fileUpload" class="file-upload-btn" title="Upload file">
                                    üìÅ Upload File
                                    <input type="file" id="fileUpload" accept=".txt,.pdf,.docx,.jpg,.jpeg,.png" style="display: none;">
                                </label>
                                <button id="sendBtn" class="send-btn" title="Send message">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                                        <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    Send
                                </button>
                            </div>
                        </div>
                        <div class="input-hint">Press Ctrl+Enter to send ‚Ä¢ Supports text, PDF, images, and DOCX files</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- How It Works Section -->
        <section class="section how-section" id="how">
            <h2>How ScanCare Works</h2>
            <p class="sub">Your journey from medical report to AI insights in four simple steps.</p>
            <div class="timeline">
                <div class="progress" aria-hidden="true"></div>
                <div class="step" data-idx="01">
                    <div class="icon-badge" aria-hidden="true">
                        <svg width="26" height="26" viewBox="0 0 24 24" fill="none"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="#ff3b3b" stroke-width="1.8"/><polyline points="14 2 14 8 20 8" stroke="#ff3b3b" stroke-width="1.8"/></svg>
                    </div>
                    <div class="step-card">
                        <h3>Upload Your Report</h3>
                        <p>Submit medical reports in text, PDF, image, or DOCX format via the chat interface.</p>
                        <span class="pill">Step ‚Ä¢ Start</span>
                    </div>
                </div>

                <div class="step" data-idx="02">
                    <div class="icon-badge" aria-hidden="true">
                        <svg width="26" height="26" viewBox="0 0 24 24" fill="none"><path d="M12 2L2 7l10 5 10-5-10-5z" stroke="#ff3b3b" stroke-width="1.8"/><path d="M2 17l10 5 10-5" stroke="#ff3b3b" stroke-width="1.8"/><path d="M2 12l10 5 10-5" stroke="#ff3b3b" stroke-width="1.8"/></svg>
                    </div>
                    <div class="step-card">
                        <h3>AI Processing</h3>
                        <p>Our advanced AI extracts key information, medical values, and identifies important findings.</p>
                        <span class="pill">Analysis</span>
                    </div>
                </div>

                <div class="step" data-idx="03">
                    <div class="icon-badge" aria-hidden="true">
                        <svg width="26" height="26" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="3" stroke="#ff3b3b" stroke-width="1.8"/><path d="M12 1v6M12 17v6M4.22 4.22l4.24 4.24M15.54 15.54l4.24 4.24M1 12h6M17 12h6M4.22 19.78l4.24-4.24M15.54 8.46l4.24-4.24" stroke="#ff3b3b" stroke-width="1.8" stroke-linecap="round"/></svg>
                    </div>
                    <div class="step-card">
                        <h3>Generate Insights</h3>
                        <p>Receive clear explanations of medical terminology, normal ranges, and highlighted concerns.</p>
                        <span class="pill">Insights</span>
                    </div>
                </div>

                <div class="step" data-idx="04">
                    <div class="icon-badge" aria-hidden="true">
                        <svg width="26" height="26" viewBox="0 0 24 24" fill="none"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke="#ff3b3b" stroke-width="1.8"/><path d="M8 10h.01M12 10h.01M16 10h.01" stroke="#ff3b3b" stroke-width="2" stroke-linecap="round"/></svg>
                    </div>
                    <div class="step-card">
                        <h3>Interactive Chat</h3>
                        <p>Ask follow-up questions, request clarifications, and get personalized health guidance.</p>
                        <span class="pill">Chat</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Why ScanCare Section -->
        <section class="section problem-section" id="why">
            <h2>Why ScanCare matters</h2>
            <p class="sub">Common challenges people face when trying to understand their medical reports.</p>
            <div class="problem-grid">
                <div class="problem-card" data-idx="01">
                    <div class="p-icon" aria-hidden="true">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z" stroke="#ff3b3b" stroke-width="1.6"/><path d="M12 6v6l4 2" stroke="#ff3b3b" stroke-width="1.6" stroke-linecap="round"/></svg>
                    </div>
                    <h3>Complex Medical Jargon</h3>
                    <p>Medical reports are full of technical terms that are difficult for patients to understand without medical training.</p>
                    <div class="p-metric">Confusing<small>Technical language</small></div>
                </div>
                <div class="problem-card" data-idx="02">
                    <div class="p-icon" aria-hidden="true">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none"><rect x="3" y="3" width="18" height="18" rx="2" stroke="#ff3b3b" stroke-width="1.6"/><path d="M3 9h18M9 21V9" stroke="#ff3b3b" stroke-width="1.6"/></svg>
                    </div>
                    <h3>Delayed Doctor Appointments</h3>
                    <p>Getting answers from doctors can take days or weeks. Patients need immediate clarity on their test results.</p>
                    <div class="p-metric">Time-consuming<small>Long wait times</small></div>
                </div>
                <div class="problem-card" data-idx="03">
                    <div class="p-icon" aria-hidden="true">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z" stroke="#ff3b3b" stroke-width="1.6"/></svg>
                    </div>
                    <h3>Anxiety & Uncertainty</h3>
                    <p>Not understanding health reports can cause unnecessary stress and worry. Quick, clear insights bring peace of mind.</p>
                    <div class="p-metric">Stressful<small>Health anxiety</small></div>
                </div>
            </div>
        </section>

        <!-- Features Stack Section -->
        <section class="section features-section" id="features">
            <h2>What ScanCare Offers</h2>
            <p class="sub">Comprehensive medical report analysis powered by advanced AI‚Äîscroll to explore features.</p>
            <div class="carousel" id="featureCarouselWrap">
                <button class="caro-btn prev" id="caroPrev" aria-label="Previous feature">‚Äπ</button>
                <div class="stack" id="featureCarousel">
                <article class="stack-card" data-idx="01">
                    <div class="f-head">
                        <div class="f-icon" aria-hidden="true">
                            <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="#ff3b3b" stroke-width="1.8"/><polyline points="14 2 14 8 20 8" stroke="#ff3b3b" stroke-width="1.8"/></svg>
                        </div>
                        <div class="f-title">Multi-Format Support</div>
                    </div>
                    <p class="f-body">Upload and analyze medical reports in various formats.</p>
                    <ul class="feature-list">
                        <li>Text and PDF document analysis</li>
                        <li>Image report scanning (JPG, PNG)</li>
                        <li>DOCX file processing</li>
                    </ul>
                </article>

                <article class="stack-card" data-idx="02">
                    <div class="f-head">
                        <div class="f-icon" aria-hidden="true">
                            <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="3" stroke="#ff3b3b" stroke-width="1.8"/><path d="M12 1v6M12 17v6M4.22 4.22l4.24 4.24M15.54 15.54l4.24 4.24M1 12h6M17 12h6M4.22 19.78l4.24-4.24M15.54 8.46l4.24-4.24" stroke="#ff3b3b" stroke-width="1.8" stroke-linecap="round"/></svg>
                        </div>
                        <div class="f-title">Intelligent Analysis</div>
                    </div>
                    <p class="f-body">AI-powered insights that help you understand your health data.</p>
                    <ul class="feature-list">
                        <li>Key findings extraction and summary</li>
                        <li>Medical terminology explained simply</li>
                        <li>Normal range comparisons</li>
                    </ul>
                </article>

                <article class="stack-card" data-idx="03">
                    <div class="f-head">
                        <div class="f-icon" aria-hidden="true">
                            <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke="#ff3b3b" stroke-width="1.8"/></svg>
                        </div>
                        <div class="f-title">Interactive Chat</div>
                    </div>
                    <p class="f-body">Have natural conversations about your health reports.</p>
                    <ul class="feature-list">
                        <li>Ask follow-up questions</li>
                        <li>Request clarifications on medical terms</li>
                        <li>Get personalized health guidance</li>
                    </ul>
                </article>

                <article class="stack-card" data-idx="04">
                    <div class="f-head">
                        <div class="f-icon" aria-hidden="true">
                            <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M4 12a8 8 0 1116 0 8 8 0 01-16 0z" stroke="#ff3b3b" stroke-width="1.8"/><path d="M8 12h8" stroke="#ff3b3b" stroke-width="1.8" stroke-linecap="round"/></svg>
                        </div>
                        <div class="f-title">Observability</div>
                    </div>
                    <p class="f-body">See what‚Äôs happening and why decisions were made.</p>
                    <ul class="feature-list">
                        <li>Structured JSON event logging</li>
                        <li>Policy and events API endpoints</li>
                        <li>Block/allow/redact rationales</li>
                    </ul>
                </article>

                <article class="stack-card" data-idx="05">
                    <div class="f-head">
                        <div class="f-icon" aria-hidden="true">
                            <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M22 12h-4l-3 9L9 3l-3 9H2" stroke="#ff3b3b" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
                        </div>
                        <div class="f-title">Health Insights</div>
                    </div>
                    <p class="f-body">Actionable information to support your health journey.</p>
                    <ul class="feature-list">
                        <li>Identify potential concerns</li>
                        <li>Suggest relevant follow-up questions</li>
                        <li>Provide context for medical values</li>
                    </ul>
                </article>
                </div>
                <button class="caro-btn next" id="caroNext" aria-label="Next feature">‚Ä∫</button>
            </div>
        </section>

        <!-- Final Call To Action -->
        <section class="cta-section" id="cta">
            <div class="cta-halo" aria-hidden="true"></div>
            <div class="cta-wrap">
                <h2>Ready to understand your health better?</h2>
                <p class="sub">Get instant AI-powered insights on your medical reports with ScanCare ‚Äî your personal health analysis assistant.</p>
                <div class="cta-stats" aria-hidden="true">
                    <div class="stat"><div class="num">AI-Powered</div><div class="label">Advanced Analysis</div></div>
                    <div class="stat"><div class="num">Multi-Format</div><div class="label">Text ‚Ä¢ PDF ‚Ä¢ Images</div></div>
                    <div class="stat"><div class="num">Secure</div><div class="label">Privacy-First Design</div></div>
                </div>
                <div class="cta-actions">
                    <a class="cta-btn" href="#demo" aria-label="Try ScanCare now"><span>Try Now</span><span class="arrow">‚Üí</span></a>
                    <a class="cta-link" href="mailto:support@scancare.com" aria-label="Contact us">Contact Us</a>
                </div>
            </div>
        </section>

    </main>

    <footer class="footer">¬© <span id="year"></span> ScanCare - AI-Powered Health Insights</footer>
    <!-- GSAP for subtle motion & scroll-driven effects -->
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/ScrollTrigger.min.js"></script>
    <script>
        // Footer year
        document.getElementById('year').textContent = new Date().getFullYear();

        function copyFrom(id, btn){
            try {
                const text = document.getElementById(id)?.textContent || '';
                if (!text) return;
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(text);
                } else {
                    const ta = document.createElement('textarea');
                    ta.value = text; document.body.appendChild(ta); ta.select();
                    document.execCommand('copy'); document.body.removeChild(ta);
                }
                if (btn) { const orig = btn.textContent; btn.textContent = 'Copied'; setTimeout(()=>btn.textContent = orig, 900); }
            } catch(e) { console.error('Copy failed', e); }
        }

        // (removed old one-shot demo send/reset helpers)

        // Chat helpers and Ctrl+Enter to send
        document.addEventListener('DOMContentLoaded', () => {
            const ci = document.getElementById('chatInput');
            const sendBtn = document.getElementById('sendBtn');
            const fileUpload = document.getElementById('fileUpload');
            
            // Enter to send
            if (ci) {
                ci.addEventListener('keydown', (e) => {
                    if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') { 
                        e.preventDefault(); 
                        sendChat(); 
                    }
                });
            }
            
            // Send button click
            if (sendBtn) {
                sendBtn.addEventListener('click', sendChat);
            }
            
            // File upload
            if (fileUpload) {
                fileUpload.addEventListener('change', handleFileUpload);
            }
            // Add error card styles
            const style = document.createElement('style');
            style.innerHTML = `
                .error-card {
                    background: #2a2a2a;
                    border-left: 4px solid #ff3b3b;
                    padding: 18px 22px;
                    margin: 18px 0;
                    border-radius: 8px;
                    color: #fff;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
                    font-size: 1.05em;
                }
                .error-icon {
                    font-size: 2em;
                    margin-bottom: 8px;
                }
                .error-title {
                    font-weight: bold;
                    font-size: 1.2em;
                    margin-bottom: 6px;
                }
                .error-message {
                    margin-bottom: 8px;
                }
                .error-hint {
                    color: #ffd700;
                    font-size: 0.98em;
                }
            `;
            document.head.appendChild(style);

            // Populate example prompts
            populateExamples();

            // Default tab
            const saved = localStorage.getItem('activeTab') || 'flow';
            showTab(saved);

            // Resizer
            initResize();

            // Feature carousel activation
            initFeatureCarousel();

            // How-it-works progress (fallback if GSAP not available)
            initHowProgress();

            // GSAP animations
            initGSAPAnimations();

            // Immersive hovers
            initInteractiveHover();
            initMagneticButtons();

            // Navbar shrink on scroll
            initNavShrink();

            // Custom cursor dot
            initCustomCursor();
        });

        function showTab(name, btn){
            const tabs = ['flow','json'];
            tabs.forEach(t => {
                const el = document.getElementById('tab-' + t);
                if (el) el.classList.toggle('active', t === name);
            });
            localStorage.setItem('activeTab', name);
            // Toggle active class on buttons if provided
            if (btn) {
                const all = btn.parentElement.querySelectorAll('.tab-btn');
                all.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            } else {
                // ensure first tab button is active initially
                const first = document.querySelector('.tabbar .tab-btn[data-tab="' + name + '"]');
                if (first) {
                    const siblings = first.parentElement.querySelectorAll('.tab-btn');
                    siblings.forEach(b => b.classList.remove('active'));
                    first.classList.add('active');
                }
            }
        }

        // Navbar shrink behavior: add .shrink when scrolled down, restore at top
        function initNavShrink(){
            const nav = document.querySelector('.nav');
            if (!nav) return;
            const apply = () => {
                const y = window.scrollY || window.pageYOffset;
                // threshold where the navbar tightens up
                const threshold = 24;
                if (y > threshold) nav.classList.add('shrink');
                else nav.classList.remove('shrink');
            };
            apply();
            window.addEventListener('scroll', apply, {passive:true});
        }

        // Custom cursor: solid white dot following the pointer without lag
        function initCustomCursor(){
            const isCoarse = window.matchMedia('(pointer: coarse)').matches; // skip on touch
            if (isCoarse) return;
            const dot = document.createElement('div');
            dot.className = 'cursor-dot';
            document.body.appendChild(dot);

            const radius = 5; // half of 10px
            let x = -100, y = -100;

            const onMove = (e) => { x = e.clientX; y = e.clientY; };
            window.addEventListener('mousemove', onMove, {passive:true});
            window.addEventListener('mouseleave', () => { dot.style.opacity = '0'; });
            window.addEventListener('mouseenter', () => { dot.style.opacity = '1'; });

            // rAF render loop for ultra-smooth tracking
            const render = () => {
                dot.style.transform = `translate3d(${x - radius}px, ${y - radius}px, 0)`;
                requestAnimationFrame(render);
            };
            requestAnimationFrame(render);
        }

        function initHowProgress(){
            // If GSAP is available, ScrollTrigger will drive the progress; skip manual logic
            if (window.gsap && window.ScrollTrigger) return;
            const timeline = document.querySelector('#how .timeline');
            const bar = timeline ? timeline.querySelector('.progress') : null;
            if (!timeline || !bar) return;
            const update = () => {
                const r = timeline.getBoundingClientRect();
                const vh = window.innerHeight || document.documentElement.clientHeight;
                const total = r.height;
                // Start earlier: trigger when the top of the timeline reaches ~85% of the viewport height (near bottom)
                const trigger = vh * 0.85;
                const progressed = trigger - r.top; // becomes positive earlier
                const clamped = Math.min(total, Math.max(0, progressed));
                // Since CSS sets height:100% with scaleY, convert to ratio
                const ratio = total ? (clamped / total) : 0;
                bar.style.transform = 'scaleY(' + ratio + ')';
            };
            update();
            window.addEventListener('scroll', update, {passive:true});
            window.addEventListener('resize', update);
        }

        function initGSAPAnimations(){
            if (!(window.gsap && window.ScrollTrigger)) return;
            const gs = window.gsap; gs.registerPlugin(window.ScrollTrigger);

            // Nav subtle fade-in
            gs.from('.nav', {y: -20, opacity: 0, duration: 0.6, ease: 'power2.out'});

            // Workbench entrance
            gs.from('.workbench', {opacity: 0, y: 20, duration: 0.7, ease: 'power2.out', scrollTrigger: {trigger: '#demo', start: 'top 80%'}});
            gs.from('#demo .card', {opacity: 0, y: 18, duration: 0.5, stagger: 0.08, ease: 'power2.out', scrollTrigger: {trigger: '#demo .wb-body', start: 'top 75%'}});

            // Why section cards
            gs.from('#why .problem-card', {opacity: 0, y: 22, duration: 0.6, stagger: 0.1, ease: 'power2.out', scrollTrigger: {trigger: '#why', start: 'top 80%'}});

            // Features cards (first reveal)
            gs.from('#features .stack-card', {opacity: 0, y: 20, duration: 0.6, stagger: 0.08, ease: 'power2.out', scrollTrigger: {trigger: '#features', start: 'top 80%'}});

            // Timeline steps pop-in
            gs.from('#how .step', {opacity: 0, x: -14, duration: 0.5, stagger: 0.12, ease: 'power2.out', scrollTrigger: {trigger: '#how', start: 'top 85%'}});
            gs.from('#how .icon-badge', {scale: 0.8, opacity: 0, duration: 0.4, stagger: 0.12, ease: 'back.out(1.6)', scrollTrigger: {trigger: '#how', start: 'top 85%'}});

            // Timeline progress driven by ScrollTrigger (smooth, synced)
            const tlWrap = document.querySelector('#how .timeline');
            const bar = tlWrap ? tlWrap.querySelector('.progress') : null;
            if (tlWrap && bar){
                gs.set(bar, {transformOrigin: 'top'});
                gs.to(bar, {scaleY: 1, ease: 'none', scrollTrigger: {
                    trigger: tlWrap,
                    start: 'top 90%',
                    end: 'bottom 20%',
                    scrub: true
                }});
            }

            // CTA reveal
            gs.from('#cta .cta-wrap', {opacity: 0, y: 26, duration: 0.7, ease: 'power2.out', scrollTrigger: {trigger: '#cta', start: 'top 80%'}});
            gs.from('#cta .stat', {opacity: 0, y: 16, duration: 0.5, stagger: 0.08, ease: 'power2.out', scrollTrigger: {trigger: '#cta', start: 'top 75%'}});
        }

        function initInteractiveHover(){
            // Respect reduced motion and touch devices
            const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            const isCoarse = window.matchMedia('(pointer: coarse)').matches;
            if (prefersReduced || isCoarse) return;

            const tiltMax = 6; // degrees
            const selectors = '.problem-card, .stack-card, .step-card, #demo .card, .stat';
            const els = Array.from(document.querySelectorAll(selectors));
            els.forEach(el => {
                el.classList.add('interactive');
                let raf = null;
                const update = (e) => {
                    const r = el.getBoundingClientRect();
                    const x = (e.clientX - r.left);
                    const y = (e.clientY - r.top);
                    el.style.setProperty('--mx', x + 'px');
                    el.style.setProperty('--my', y + 'px');
                    const rx = ((y / r.height) - 0.5) * -2 * tiltMax; // invert so up moves up
                    const ry = ((x / r.width) - 0.5) * 2 * tiltMax;
                    el.style.transform = `perspective(800px) rotateX(${rx.toFixed(2)}deg) rotateY(${ry.toFixed(2)}deg) translateZ(2px)`;
                };
                const onMove = (e) => { if (raf) cancelAnimationFrame(raf); raf = requestAnimationFrame(() => update(e)); };
                const onLeave = () => { if (raf) cancelAnimationFrame(raf); el.style.transform = 'perspective(800px) translateZ(0)'; };
                el.addEventListener('mousemove', onMove);
                el.addEventListener('mouseleave', onLeave);
            });
        }

        function initMagneticButtons(){
            const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            const isCoarse = window.matchMedia('(pointer: coarse)').matches;
            if (isCoarse) return;

            const btns = document.querySelectorAll('.btn-try, .cta-btn');
            btns.forEach(btn => {
                let raf = null;
                const strength = 14; // px
                const move = (e) => {
                    const r = btn.getBoundingClientRect();
                    const x = e.clientX - (r.left + r.width/2);
                    const y = e.clientY - (r.top + r.height/2);
                    const dx = Math.max(-strength, Math.min(strength, x * 0.15));
                    const dy = Math.max(-strength, Math.min(strength, y * 0.15));
                    if (window.gsap && !prefersReduced){
                        gsap.to(btn, {x: dx, y: dy, duration: 0.25, ease: 'power2.out'});
                    } else {
                        btn.style.transform = `translate(${dx}px, ${dy}px)`;
                    }
                };
                const onMove = (e) => { if (raf) cancelAnimationFrame(raf); raf = requestAnimationFrame(() => move(e)); };
                const reset = () => {
                    if (window.gsap && !prefersReduced){ gsap.to(btn, {x: 0, y: 0, duration: 0.3, ease: 'power2.out'}); }
                    else { btn.style.transform = 'translate(0,0)'; }
                };
                btn.addEventListener('mousemove', onMove);
                btn.addEventListener('mouseleave', reset);
            });
        }

        function initFeatureCarousel(){
            const scroller = document.getElementById('featureCarousel');
            if (!scroller) return;
            const cards = Array.from(scroller.querySelectorAll('.stack-card'));
            const prevBtn = document.getElementById('caroPrev');
            const nextBtn = document.getElementById('caroNext');

            function nearestIndex(){
                const center = scroller.getBoundingClientRect().left + scroller.clientWidth/2;
                let best = 0, min = Infinity;
                cards.forEach((c,i)=>{
                    const r = c.getBoundingClientRect();
                    const cc = r.left + r.width/2;
                    const d = Math.abs(cc - center);
                    if (d < min){ min = d; best = i; }
                });
                return best;
            }
            function setActive(){
                const idx = nearestIndex();
                cards.forEach((c,i)=>c.classList.toggle('active', i===idx));
                if (prevBtn) prevBtn.disabled = idx === 0;
                if (nextBtn) nextBtn.disabled = idx === cards.length - 1;
            }
            function scrollToIndex(i){
                const clamped = Math.max(0, Math.min(cards.length-1, i));
                cards[clamped].scrollIntoView({behavior:'smooth', inline:'center', block:'nearest'});
            }

            scroller.addEventListener('scroll', ()=>{
                // rAF to avoid excessive toggles
                if (scroller._raf) cancelAnimationFrame(scroller._raf);
                scroller._raf = requestAnimationFrame(setActive);
            });
            if (prevBtn) prevBtn.addEventListener('click', ()=> scrollToIndex(nearestIndex()-1));
            if (nextBtn) nextBtn.addEventListener('click', ()=> scrollToIndex(nearestIndex()+1));

            // initialize
            setTimeout(setActive, 0);
        }

        function toggleWrap(el){
            const wrapping = document.body.classList.toggle('no-wrap');
            el.textContent = wrapping ? 'No Wrap' : 'Wrap';
        }

        function initResize(){
            const grid = document.getElementById('wbGrid');
            const divider = document.getElementById('wbDivider');
            if (!grid || !divider) return;
            let dragging = false; let startX = 0; let startLeft = 0; let total = 0;

            const setCols = (leftPx) => {
                const rightPx = Math.max(280, total - leftPx - divider.offsetWidth);
                const leftFinal = Math.max(320, leftPx);
                const rightFinal = Math.max(320, rightPx);
                grid.style.setProperty('--left-col', leftFinal + 'px');
                grid.style.setProperty('--right-col', rightFinal + 'px');
                localStorage.setItem('wb_split', JSON.stringify({left:leftFinal, right:rightFinal}));
            };

            const onMove = (e) => {
                if (!dragging) return;
                const dx = (e.touches ? e.touches[0].clientX : e.clientX) - startX;
                setCols(startLeft + dx);
            };
            const onUp = () => { dragging = false; document.removeEventListener('mousemove', onMove); document.removeEventListener('mouseup', onUp); document.removeEventListener('touchmove', onMove); document.removeEventListener('touchend', onUp); };

            divider.addEventListener('mousedown', (e)=>{
                dragging = true; startX = e.clientX; total = grid.getBoundingClientRect().width; startLeft = parseFloat(getComputedStyle(grid).getPropertyValue('--left-col')) || (total*0.55);
                document.addEventListener('mousemove', onMove); document.addEventListener('mouseup', onUp);
            });
            divider.addEventListener('touchstart', (e)=>{
                dragging = true; startX = e.touches[0].clientX; total = grid.getBoundingClientRect().width; startLeft = parseFloat(getComputedStyle(grid).getPropertyValue('--left-col')) || (total*0.55);
                document.addEventListener('touchmove', onMove, {passive:false}); document.addEventListener('touchend', onUp);
            });

            // restore saved split
            const saved = localStorage.getItem('wb_split');
            if (saved) {
                try { const {left,right} = JSON.parse(saved); grid.style.setProperty('--left-col', left + 'px'); grid.style.setProperty('--right-col', right + 'px'); } catch {}
            }
        }

        // --- Chat UI ---
        const chat = { messages: [] };
        function addMessage(role, text){
            chat.messages.push({role, text});
            const box = document.getElementById('chatMessages');
            if (!box) return;
            
            const msgDiv = document.createElement('div');
            msgDiv.className = `message ${role === 'user' ? 'user-message' : 'bot-message'}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = role === 'user' ? 'üë§' : 'ü©∫';
            
            const content = document.createElement('div');
            content.className = 'message-content';
            
            // Parse markdown-like formatting
            const formatted = text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\n/g, '<br>');
            content.innerHTML = formatted;
            
            msgDiv.appendChild(avatar);
            msgDiv.appendChild(content);
            box.appendChild(msgDiv);
            box.scrollTop = box.scrollHeight;
        }
        
        function setLoading(isLoading) {
            const sendBtn = document.getElementById('sendBtn');
            const chatInput = document.getElementById('chatInput');
            
            if (isLoading) {
                sendBtn.disabled = true;
                sendBtn.innerHTML = '<div class="spinner"></div> Analyzing...';
                chatInput.disabled = true;
                
                // Add loading message
                const box = document.getElementById('chatMessages');
                const loadingDiv = document.createElement('div');
                loadingDiv.className = 'message bot-message';
                loadingDiv.id = 'loadingMessage';
                loadingDiv.innerHTML = `
                    <div class="message-avatar">ü©∫</div>
                    <div class="message-content">
                        <div class="loading-indicator">
                            <div class="spinner"></div>
                            Analyzing your medical data...
                        </div>
                    </div>
                `;
                box.appendChild(loadingDiv);
                box.scrollTop = box.scrollHeight;
            } else {
                sendBtn.disabled = false;
                sendBtn.innerHTML = `
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Send
                `;
                chatInput.disabled = false;
                
                // Remove loading message
                const loadingMsg = document.getElementById('loadingMessage');
                if (loadingMsg) loadingMsg.remove();
            }
        }
        
        async function sendChat(){
            const input = document.getElementById('chatInput');
            const text = input.value.trim();
            if (!text) return;
            input.value = '';
            addMessage('user', text);
            setLoading(true);
            try{
                const res = await fetch('/analyze', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({query: text}) });
                const raw = await res.text();
                if (!raw) throw new Error(`Empty response (${res.status})`);
                let data;
                try { data = JSON.parse(raw); }
                catch(parseErr){ throw new Error(`Bad JSON (${res.status}): ${raw.slice(0,160)}`); }
                if (data.status === 'success'){
                    addMessage('assistant', data.analysis || data.response || '(no response)');
                } else {
                    // Show detailed error message
                    let errorMsg = '‚ùå **Error**\n\n';
                    errorMsg += (data.message || data.error || 'Unknown error') + '\n\n';
                    if (data.hint) {
                        errorMsg += `üí° **Hint:** ${data.hint}`;
                    }
                    addMessage('assistant', errorMsg);
                }
            } catch(e){
                addMessage('assistant', '‚ùå **Connection Error**\n\n' + e.message + '\n\nüí° Please check if the server is running.');
            } finally {
                setLoading(false);
            }
        }

        // Example medical queries and reports
        const EXAMPLES = [
            {label: 'Question ‚Ä¢ Blood pressure', text: 'What does a blood pressure reading of 130/85 mean? Is it concerning?'},
            {label: 'Question ‚Ä¢ Cholesterol', text: 'Can you explain what HDL and LDL cholesterol are and what good ranges are?'},
            {label: 'Question ‚Ä¢ Diabetes', text: 'What is HbA1c and what does a level of 6.2% indicate?'},
            {label: 'Sample Report ‚Ä¢ Blood Test', text: 'CBC Report:\nWBC: 7.5 (4-11)\nRBC: 4.8 (4.5-5.5)\nHemoglobin: 14.2 g/dL (13-17)\nPlatelet: 250 (150-400)\nPlease analyze these results.'},
            {label: 'Question ‚Ä¢ Vitamin D', text: 'My Vitamin D level is 18 ng/mL. What does this mean and what should I do?'},
            {label: 'Question ‚Ä¢ Thyroid', text: 'What is TSH and what do levels above normal indicate?'}
        ];
        function populateExamples(){
            const sel = document.getElementById('examplesSelect');
            if (!sel) return;
            sel.innerHTML = '';
            EXAMPLES.forEach((ex, i) => {
                const opt = document.createElement('option');
                opt.value = i.toString();
                opt.textContent = ex.label;
                sel.appendChild(opt);
            });
            sel.selectedIndex = 0;
        }
        function insertExample(){
            const sel = document.getElementById('examplesSelect');
            const idx = sel && sel.value ? parseInt(sel.value, 10) : 0;
            const ex = EXAMPLES[idx] || EXAMPLES[0];
            const input = document.getElementById('chatInput');
            if (input && ex){ input.value = ex.text; input.focus(); }
        }
        
        // Handle file uploads
        async function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            addMessage('user', `[Uploading file: ${file.name}]`);
            setLoading(true);
            
            try {
                const formData = new FormData();
                formData.append('report_file', file);
                const res = await fetch('/analyze', {
                    method: 'POST',
                    body: formData
                });
                const raw = await res.text();
                if (!raw) throw new Error(`Empty response (${res.status})`);
                let data;
                try { data = JSON.parse(raw); }
                catch(parseErr){ throw new Error(`Bad JSON (${res.status}): ${raw.slice(0,160)}`); }
                if (data.status === 'success'){
                    addMessage('assistant', data.analysis || data.response || '(no response)');
                } else {
                    // Show detailed error message for file uploads
                    let errorMsg = '<div class="error-card">'
                        + '<div class="error-icon">‚ùå</div>'
                        + '<div class="error-title">Upload Error</div>'
                        + '<div class="error-message">' + (data.message || data.error || 'Failed to process file') + '</div>';
                    if (data.hint) {
                        errorMsg += '<div class="error-hint">üí° <strong>Hint:</strong> ' + data.hint + '</div>';
                    }
                    errorMsg += '</div>';
                    addMessage('assistant', errorMsg);
                }
            } catch(e){
                let errorMsg = '<div class="error-card">'
                    + '<div class="error-icon">‚ùå</div>'
                    + '<div class="error-title">Upload Error</div>'
                    + '<div class="error-message">' + e.message + '</div>'
                    + '<div class="error-hint">üí° Please ensure the file is a valid medical report image (PNG, JPG, JPEG) or text file.</div>'
                    + '</div>';
                addMessage('assistant', errorMsg);
            } finally {
                setLoading(false);
                event.target.value = '';
            }
        }
        
        function resetChat(){
            chat.messages = [];
            const box = document.getElementById('chatMessages');
            if (box) {
                box.innerHTML = `
                    <div class="message bot-message">
                        <div class="message-avatar">ü©∫</div>
                        <div class="message-content">
                            <p><strong>Hello! I'm ScanCare AI Assistant.</strong></p>
                            <p>I can help you understand your medical reports. You can:</p>
                            <ul>
                                <li>üìÑ Paste your medical report text below</li>
                                <li>üìÅ Upload a file (PDF, image, DOCX, or TXT)</li>
                                <li>üí¨ Ask me health questions</li>
                            </ul>
                        </div>
                    </div>
                `;
            }
            const input = document.getElementById('chatInput');
            if (input) {
                input.value = '';
                input.focus();
            }
        }
    </script>
    <style>
        /* Chat UI styles */
        .chat-messages{ flex:1 1 auto; min-height:280px; max-height:60vh; overflow:auto; padding:12px; display:flex; flex-direction:column; gap:10px; background: rgba(255,255,255,0.02); border:1px solid var(--border); border-radius:12px; }
        .chat-input{ display:flex; gap:10px; align-items:center; }
        .chat-input input{ flex:1; background: var(--bg-elev); color: var(--text); border:1px solid var(--border); border-radius:12px; padding:12px 14px; font-size:15px; }
        .chat-msg{ display:flex; }
        .chat-msg.user{ justify-content: flex-end; }
        .chat-msg.assistant{ justify-content: flex-start; }
        .chat-msg .bubble{ max-width: 80%; padding: 12px 14px; border-radius: 14px; border:1px solid rgba(255,255,255,0.14); background: rgba(255,255,255,0.06); box-shadow: var(--shadow); }
        .chat-msg.user .bubble{ background: linear-gradient(135deg, #ffffff, #dcdcdc); color:#001018; border-color: rgba(0,0,0,0.22); }
    </style>
</body>
</html>